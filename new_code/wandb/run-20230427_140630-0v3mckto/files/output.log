FF_model(
  (model): ModuleList(
    (0): Linear(in_features=784, out_features=2000, bias=True)
    (1): Linear(in_features=2000, out_features=2000, bias=True)
    (2): Linear(in_features=2000, out_features=2000, bias=True)
    (3): Linear(in_features=2000, out_features=2000, bias=True)
  )
  (ff_loss): BCEWithLogitsLoss()
  (linear_classifier): Sequential(
    (0): Linear(in_features=6000, out_features=10, bias=False)
  )
  (classification_loss): CrossEntropyLoss()
)
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
tensor([-2742.0969, -2651.5212, -2634.4702, -2722.4526, -2640.7954, -2583.7256,
        -2679.8296, -2634.8979, -2610.8560, -2679.3237, -2667.7100, -2651.6667,
        -2606.5767, -2590.4146, -2690.4834, -2622.1904, -2667.4309, -2658.3184,
        -2596.2507, -2685.6646, -2619.0190, -2598.7896, -2678.3169, -2647.2012,
        -2601.0439, -2640.4089, -2667.1501, -2562.2593, -2642.2271, -2637.2573,
        -2622.8972, -2642.6633, -2668.4507, -2659.0618, -2596.1345, -2636.8447,
        -2542.1321, -2600.3459, -2613.7422, -2685.9231, -2648.8184, -2579.1277,
        -2637.7771, -2599.8687, -2652.3362, -2670.3254, -2620.4937, -2625.5359,
        -2686.1729, -2631.8901, -2623.8999, -2614.9380, -2664.4998, -2641.3394,
        -2691.1665, -2717.6016, -2639.0720, -2613.4883, -2596.1470, -2613.2363,
        -2719.9038, -2644.8813, -2608.4863, -2609.7822, -2614.2944, -2672.1895,
        -2599.1392, -2650.2109, -2678.4641, -2681.2559, -2639.0952, -2639.2046,
        -2639.7261, -2656.5718, -2642.8918, -2677.5627, -2676.7500, -2661.0139,
        -2596.8193, -2648.3838, -2624.1208, -2621.8154, -2634.2026, -2663.9165,
        -2666.2278, -2607.2314, -2583.8623, -2619.0444, -2580.5581, -2687.7241,
        -2671.9561, -2637.8000, -2635.4758, -2605.7400, -2658.6465, -2718.4353,
        -2663.2026, -2566.1904, -2716.8853, -2612.1675, -2645.5103, -2701.0813,
        -2699.3652, -2574.2251, -2648.3494, -2654.2412, -2656.9302, -2667.2764,
        -2596.9995, -2700.5063, -2688.9189, -2675.2495, -2644.4622, -2666.3291,
        -2639.2773, -2620.1611, -2612.1421, -2625.0203, -2636.9609, -2622.1648,
        -2667.0339, -2721.4214, -2544.5518, -2674.5615, -2683.4565, -2658.8647,
        -2647.3462, -2621.2305, -2648.8503, -2634.1919, -2660.2676, -2640.6030,
        -2655.7339, -2674.4927, -2644.4463, -2669.8809, -2710.6616, -2609.8398,
        -2636.8259, -2726.8457, -2658.6125, -2649.4917, -2602.8247, -2649.6001,
        -2609.6316, -2629.7661, -2620.4421, -2669.3716, -2643.5884, -2681.7783,
        -2675.6189, -2606.2263, -2648.6946, -2631.6726, -2608.4653, -2698.1387,
        -2608.0325, -2636.3337, -2644.8657, -2604.8809, -2639.1035, -2631.5078,
        -2660.4470, -2707.5842, -2664.0518, -2615.8862, -2675.8774, -2645.1426,
        -2669.4800, -2719.8457, -2708.6172, -2566.4929, -2641.6672, -2652.4019,
        -2636.7373, -2626.8057, -2712.3984, -2717.7778, -2584.8264, -2622.3491,
        -2606.7451, -2650.0613, -2569.3682, -2591.8101, -2607.0415, -2619.9565,
        -2609.3179, -2616.1653, -2658.8594, -2608.4409, -2563.4775, -2592.5576,
        -2648.9390, -2625.7410, -2591.2283, -2658.4795, -2639.8135, -2699.5115,
        -2618.5981, -2643.7212, -2627.9800, -2656.8628, -2654.2891, -2678.1704,
        -2623.0063, -2646.4497, -2632.5898, -2629.8589, -2640.7295, -2706.0439,
        -2605.7300, -2643.5664, -2588.2749, -2654.0579, -2621.5652, -2623.5720,
        -2620.5942, -2650.4329, -2671.4478, -2690.7163, -2740.7837, -2611.9600,
        -2656.4316, -2640.7642, -2637.6624, -2670.8181, -2591.1970, -2614.3286,
        -2628.4502, -2630.7615, -2641.6448, -2670.2051, -2645.0791, -2675.2944,
        -2602.1753, -2579.1626, -2665.9170, -2707.3838, -2645.6162, -2635.7810,
        -2631.5020, -2674.5771, -2601.2637, -2631.7642, -2646.9336, -2601.2729,
        -2681.7288, -2676.4583, -2627.2627, -2599.0144, -2616.0134, -2692.2925,
        -2667.1526, -2635.7432, -2613.3296, -2697.1641, -2630.1108, -2631.1582,
        -2650.6348, -2610.5569, -2636.7251, -2612.7183, -2586.9155, -2644.2173,
        -2704.3081, -2610.9722, -2660.2646, -2694.0322, -2633.1438, -2637.5750,
        -2614.4058, -2659.8994, -2686.6807, -2632.4199, -2640.2915, -2724.1494,
        -2623.8279, -2661.1860, -2635.4619, -2574.1648, -2590.6646, -2607.5366,
        -2599.2788, -2571.8389, -2585.6978, -2613.5112, -2671.0344, -2623.2505,
        -2589.8728, -2663.4778, -2619.2461, -2642.8262, -2623.9561, -2636.5991,
        -2609.6345, -2707.2466, -2688.1978, -2646.2915, -2663.8660, -2595.0688,
        -2625.7634, -2704.0405, -2638.6567, -2572.1147, -2664.6167, -2695.4854,
        -2616.8535, -2667.3379, -2607.8047, -2598.1780, -2643.5234, -2606.8438,
        -2632.5325, -2660.0718, -2631.5095, -2578.1045, -2669.2910, -2616.2715,
        -2685.7856, -2604.1350, -2653.4304, -2603.3862, -2651.6299, -2648.8975,
        -2609.3381, -2636.1060, -2664.4229, -2653.0906, -2565.5850, -2650.3723,
        -2662.8164, -2646.9080, -2597.7393, -2655.2466, -2665.2559, -2648.9124,
        -2644.3208, -2677.3223, -2633.1985, -2696.0046, -2667.3984, -2640.9819,
        -2647.5259, -2705.9224, -2575.8560, -2634.8135, -2702.3608, -2580.5876,
        -2645.4377, -2618.5642, -2673.8872, -2597.0161, -2639.9929, -2665.4658,
        -2588.0894, -2662.0264, -2688.0903, -2648.3120, -2604.2349, -2647.2878,
        -2624.7385, -2602.9575, -2593.0752, -2689.7483, -2655.5271, -2652.7695,
        -2660.2063, -2586.9019, -2697.5808, -2651.2974, -2682.3140, -2644.4316,
        -2651.6958, -2703.4934, -2655.1890, -2599.5781, -2689.9375, -2596.5022,
        -2640.0581, -2659.1167, -2636.2593, -2606.7776, -2625.1484, -2702.4744,
        -2624.1423, -2685.1299, -2637.7183, -2650.1096, -2654.3296, -2657.7751,
        -2666.4021, -2591.0315, -2578.9631, -2571.7004, -2624.3784, -2619.7837,
        -2590.0527, -2670.7200, -2588.6011, -2650.2930, -2610.0464, -2618.5293,
        -2623.8140, -2613.5918, -2644.5850, -2624.5535, -2686.8735, -2634.0325,
        -2651.0457, -2609.2827, -2629.2061, -2667.3779, -2656.8616, -2689.2102,
        -2695.2480, -2625.9788, -2616.3296, -2692.8076, -2639.4028, -2646.4910,
        -2707.3354, -2637.1050, -2646.6101, -2664.9382, -2639.2292, -2634.1338,
        -2588.2266, -2622.3586, -2655.1641, -2636.0503, -2668.0273, -2613.5549,
        -2648.3481, -2667.7969, -2609.2371, -2638.5288, -2710.1089, -2668.1069,
        -2626.2869, -2584.7825, -2574.9805, -2717.4321, -2636.9644, -2644.3547,
        -2641.7515, -2574.9028, -2660.7776, -2642.5698, -2591.3391, -2677.5645,
        -2626.5898, -2714.2456, -2629.2153, -2665.7573, -2625.5669, -2665.2944,
        -2615.4241, -2577.7810, -2701.4927, -2666.1548, -2627.2061, -2579.6450,
        -2677.6411, -2635.2278, -2648.0845, -2654.8296, -2684.8679, -2703.7939,
        -2698.0083, -2636.3784, -2591.5322, -2636.2615, -2655.1497, -2640.6206,
        -2653.2058, -2705.3657, -2620.5088, -2670.2063, -2690.0327, -2638.7419,
        -2668.5352, -2690.1660, -2741.3857, -2603.7156, -2634.7646, -2620.8252,
        -2578.4634, -2639.0054, -2641.2097, -2622.4819, -2606.2520, -2593.0376,
        -2651.8218, -2662.9478, -2655.3210, -2622.4980, -2620.1550, -2578.8013,
        -2674.0469, -2635.8677, -2739.3125, -2641.0659, -2617.4966, -2705.0068,
        -2643.0552, -2590.2671, -2677.9409, -2636.8389, -2610.2808, -2689.4028,
        -2666.8682, -2653.9939, -2613.8088, -2582.1699, -2689.4243, -2616.0151,
        -2657.2490, -2660.4351, -2590.2368, -2687.0386, -2632.8552, -2591.2773,
        -2671.1716, -2645.6011, -2615.1548, -2624.0100, -2671.1362, -2554.0664,
        -2630.4346, -2634.3630, -2624.7720, -2639.1064, -2664.0469, -2666.0054,
        -2600.2129, -2632.5469, -2554.2371, -2604.4099, -2602.1514, -2699.2805,
        -2648.7119, -2588.1101, -2637.3257, -2588.8418, -2652.5442, -2670.8474,
        -2607.3057, -2632.0493, -2682.7710, -2621.2959, -2625.2998, -2602.3784,
        -2664.7905, -2643.4922, -2685.0034, -2721.7571, -2649.3215, -2611.2510,
        -2590.4009, -2619.6895, -2737.0808, -2650.5430, -2608.7031, -2612.0183,
        -2607.3096, -2671.5847, -2598.7620, -2641.0601, -2671.0879, -2673.0320,
        -2630.6084, -2650.8530, -2625.9370, -2663.3884, -2643.0652, -2667.8071,
        -2666.8647, -2648.1987, -2601.9888, -2641.0889, -2623.8037, -2619.5234,
        -2631.9150, -2646.4119, -2670.2488, -2615.5537, -2588.6719, -2625.9612,
        -2584.7747, -2679.6396, -2659.8867, -2636.3779, -2638.1304, -2630.3398,
        -2667.5259, -2732.4697, -2655.9077, -2561.1418, -2725.1226, -2634.5457,
        -2640.8401, -2697.5474, -2707.8760, -2593.4893, -2647.8618, -2658.4055,
        -2663.7349, -2684.8047, -2612.3154, -2702.3208, -2688.4944, -2679.1118,
        -2655.0325, -2665.4299, -2627.5371, -2619.3804, -2617.1143, -2612.8218,
        -2628.9424, -2607.6526, -2666.4048, -2721.5259, -2542.2515, -2675.1873,
        -2677.4873, -2658.3862, -2648.4490, -2627.1511, -2654.2222, -2624.2317,
        -2662.0891, -2647.8257, -2662.7546, -2675.6663, -2661.3787, -2687.0410,
        -2702.9829, -2601.8760, -2621.8696, -2742.4990, -2658.1348, -2641.4497,
        -2592.5337, -2650.4268, -2612.0771, -2632.7913, -2633.1841, -2654.3784,
        -2633.8049, -2666.5710, -2694.6670, -2619.8696, -2637.1482, -2623.7690,
        -2616.6299, -2700.5532, -2610.0525, -2650.5063, -2656.0393, -2610.3718,
        -2646.8379, -2636.2720, -2659.4985, -2726.4448, -2664.2554, -2629.6680,
        -2664.1270, -2640.9897, -2649.6274, -2714.1304, -2709.8499, -2572.0845,
        -2646.0015, -2649.5938, -2637.5894, -2627.2388, -2702.3967, -2727.6055,
        -2591.1104, -2625.4822, -2603.4995, -2648.1533, -2567.8662, -2599.3413,
        -2610.6851, -2618.4294, -2620.7935, -2613.0129, -2653.5752, -2618.1143,
        -2560.2690, -2590.1877, -2668.9214, -2622.4351, -2598.7285, -2662.7578,
        -2651.4717, -2692.3604, -2633.7129, -2639.2615, -2622.1426, -2661.7300,
        -2647.9895, -2695.6052, -2621.7334, -2641.2432, -2626.7739, -2634.8271,
        -2655.1191, -2700.1187, -2592.7004, -2658.5986, -2598.6748, -2644.9202,
        -2632.3696, -2627.0898, -2620.5381, -2642.5337, -2665.2412, -2694.3042,
        -2739.1077, -2608.1719, -2651.5498, -2635.0051, -2635.0276, -2694.4526,
        -2583.6406, -2618.9229, -2615.3157, -2639.2285, -2647.9519, -2662.9526,
        -2649.1814, -2670.8486, -2597.9121, -2587.6035, -2666.0337, -2704.3823,
        -2638.2822, -2634.1809, -2632.4272, -2677.4448, -2594.3730, -2635.8389,
        -2639.4336, -2602.2261, -2692.1641, -2678.6497, -2635.3308, -2602.8589,
        -2610.0190, -2685.1763, -2653.2188, -2637.0112, -2605.4160, -2700.6338,
        -2634.8979, -2634.2239, -2652.1191, -2612.0486, -2632.0938, -2609.1279,
        -2602.5513, -2627.1892, -2709.4272, -2617.3979, -2670.2949, -2697.4446,
        -2634.3872, -2640.9116, -2611.4478, -2670.9504, -2693.9622, -2630.2407,
        -2641.7354, -2721.3982, -2629.2490, -2670.8877, -2643.3599, -2586.3469,
        -2597.8960, -2600.7200, -2609.3928, -2578.4275, -2581.6826, -2601.1265,
        -2674.0552, -2619.9609, -2590.2148, -2664.7151, -2613.8862, -2646.8992,
        -2623.9189, -2637.4153, -2612.6436, -2704.3323, -2692.2197, -2644.1733,
        -2655.1196, -2609.1763, -2614.8159, -2697.6978, -2645.2534, -2574.5601,
        -2661.1245, -2698.9792, -2611.3933, -2674.8018, -2608.2905, -2606.7202,
        -2631.7893, -2605.7253, -2646.8452, -2667.9963, -2641.2495, -2579.4514,
        -2661.2397, -2614.7407, -2673.5249, -2610.5442, -2661.9272, -2592.2395,
        -2654.5581, -2648.3105, -2607.0425, -2628.6616, -2682.5193, -2669.7397,
        -2547.9082, -2652.3169, -2658.7292, -2652.0706, -2600.5713, -2650.5591,
        -2672.1326, -2644.3794, -2647.8599, -2674.0105, -2634.0393, -2685.7964,
        -2691.5479, -2629.7808, -2638.4531, -2695.7925, -2582.3643, -2629.5876,
        -2710.7561, -2569.7410, -2645.6008, -2605.1060, -2658.8086, -2607.4624,
        -2626.7173, -2665.9492, -2585.4944, -2671.5969, -2683.8396, -2664.1121,
        -2614.7334, -2652.2163, -2645.3770, -2592.8506, -2583.7666, -2675.0583,
        -2661.5273, -2654.7632, -2652.2874, -2597.8521, -2698.2705, -2652.7910,
        -2689.4138, -2644.7983, -2650.1528, -2699.3149, -2656.4680, -2604.4546,
        -2694.7483, -2592.9131, -2637.1101, -2660.7354, -2633.3579, -2592.3096,
        -2636.7717, -2696.6201, -2628.2249, -2673.5205, -2651.6831, -2651.1841,
        -2649.0215, -2665.4146, -2670.7166, -2604.8694, -2575.9077, -2585.8809,
        -2616.7100, -2622.5981, -2591.7085, -2673.6040, -2581.5520, -2655.1160,
        -2609.9810, -2622.9763, -2622.8188, -2605.7913, -2649.4204, -2617.4941,
        -2677.6270, -2626.9519, -2645.2207, -2628.9229, -2635.5386, -2675.0479,
        -2678.4739, -2676.9526, -2704.0059, -2624.1587, -2610.9619, -2692.9253,
        -2637.3928, -2627.4160, -2712.9165, -2624.1340, -2647.3708, -2677.2866,
        -2652.4578, -2624.9907, -2594.3657, -2629.9038, -2649.2979, -2635.3530,
        -2665.3311, -2603.0535, -2643.3374, -2661.3330, -2608.3013, -2639.9109,
        -2706.9492, -2680.9050, -2620.4121, -2588.9883, -2584.5151, -2723.4868,
        -2634.8506, -2635.7302, -2641.3149, -2577.5127, -2651.9497, -2646.4463,
        -2603.4973, -2686.0803, -2621.9126, -2717.0278, -2637.1030, -2673.5254,
        -2631.0173, -2677.2646, -2617.6531, -2583.1204, -2700.2078, -2665.5166,
        -2620.4475, -2580.0352, -2681.6025, -2636.9839, -2639.1497, -2657.3721,
        -2674.5132, -2707.1147, -2692.2227, -2630.9609, -2566.8208, -2630.8960,
        -2653.6040, -2642.0146, -2640.8870, -2714.3813, -2623.5830, -2654.7637,
        -2697.6438, -2643.0203, -2660.0989, -2684.2075, -2753.8281, -2610.6973,
        -2648.8774, -2607.1284, -2580.0732, -2639.6670, -2640.6821, -2632.2871,
        -2616.7441, -2601.5747, -2645.8042, -2663.3523, -2658.3564, -2626.8901,
        -2619.5459, -2583.4312, -2675.2085, -2628.2253], device='cuda:0',
       grad_fn=<MulBackward0>)
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(94)_calc_ff_loss()
-> torch.sum((torch.sigmoid(logits) > 0.5) == labels) # threshold is logits=0, so sum of squares = 784
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(95)_calc_ff_loss()
-> / z.shape[0]
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(94)_calc_ff_loss()
-> torch.sum((torch.sigmoid(logits) > 0.5) == labels) # threshold is logits=0, so sum of squares = 784
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
> /home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py(92)_calc_ff_loss()
-> with torch.no_grad():
Error executing job with overrides: []
Traceback (most recent call last):
  File "main.py", line 102, in my_main
    model = train(opt, model, optimizer)
  File "main.py", line 29, in train
    scalar_outputs = model(inputs, labels)
  File "/home/jonah/anaconda3/envs/FF/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py", line 128, in forward
    ff_loss, ff_accuracy = self._calc_ff_loss(z, posneg_labels)
  File "/home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py", line 92, in _calc_ff_loss
    with torch.no_grad():
  File "/home/jonah/Documents/school/idl/activation_ForwardForward/new_code/src/ff_model.py", line 92, in _calc_ff_loss
    with torch.no_grad():
  File "/home/jonah/anaconda3/envs/FF/lib/python3.8/bdb.py", line 88, in trace_dispatch
    return self.dispatch_line(frame)
  File "/home/jonah/anaconda3/envs/FF/lib/python3.8/bdb.py", line 113, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.